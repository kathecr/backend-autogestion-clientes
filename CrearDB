
CREATE TABLE Empresa(
	empresa_id 		NUMERIC GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nit 			VARCHAR(15) 	NOT NULL,
    nombre 			VARCHAR(70) 	NOT NULL,
    celular 		VARCHAR(10) 	NOT NULL,
    correo 			VARCHAR(50) 	NOT NULL,
    clave 			VARCHAR(32) 	NOT NULL,
    PRIMARY KEY		(empresa_id)
);

CREATE TABLE Area(
	area_id 		NUMERIC GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre 			VARCHAR(20) 	NOT NULL,
    PRIMARY KEY 	(area_id)
);

CREATE TABLE Tutorial(
	tutorial_id 	NUMERIC GENERATED BY DEFAULT ON NULL AS IDENTITY,
    titulo 			VARCHAR(40) 	NOT NULL,
    descripcion		VARCHAR(4000)	NOT NULL,
    calificacion 	FLOAT			,
    PRIMARY KEY		(tutorial_id)
);

CREATE TABLE Reporte(
	reporte_id 			NUMERIC GENERATED BY DEFAULT ON NULL AS IDENTITY,
	nombre 				VARCHAR(50) 	NOT NULL,
	tipo_generacion 	VARCHAR(10) 	NOT NULL,
	tipo_rango 			VARCHAR(10) 	NOT NULL,
	fecha_reporte 		DATE 			NOT NULL,
	fecha_generacion 	DATE 			NOT NULL,
    PRIMARY KEY			(reporte_id)
);

CREATE TABLE Agente(
	agente_id 		NUMERIC GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre 			VARCHAR(30) 	NOT NULL,
    apellido 		VARCHAR(30) 	NOT NULL,
    correo 			VARCHAR(50) 	NOT NULL,
    estado 			VARCHAR(15) 	NOT NULL,
    cedula 			VARCHAR(10) 	NOT NULL,
    area_id			NUMERIC 		NOT NULL,
    PRIMARY KEY		(agente_id)		,
    CONSTRAINT fk_area_agente FOREIGN KEY (area_id) REFERENCES Area(area_id)  
);
   
CREATE TABLE Solicitud(
	solicitud_id  	NUMERIC GENERATED BY DEFAULT ON NULL AS IDENTITY,
    caso 			VARCHAR(1000) 	NOT NULL,
    estado 			VARCHAR(15) 	NOT NULL,
    fecha_solicitud DATE 			NOT NULL,
    agente_id 		NUMERIC			NOT NULL,
    area_id			NUMERIC 		NOT NULL,
    empresa_id		NUMERIC 		NOT NULL,
    PRIMARY KEY(solicitud_id),
    CONSTRAINT fk_agente_solicitud FOREIGN KEY (agente_id) REFERENCES  Agente(agente_id),
    CONSTRAINT fk_area_solicitud FOREIGN KEY (area_id) REFERENCES  Area(area_id),
    CONSTRAINT fk_empresa_solicitud FOREIGN KEY (empresa_id) REFERENCES  Empresa(empresa_id)
);

CREATE TABLE SolicitudesXArea(
	solicitudesXArea_id 	NUMERIC GENERATED BY DEFAULT ON NULL AS IDENTITY,
	numero_solicitudes 		NUMBER(6) 	NOT NULL,
	area_id					NUMERIC 	NOT NULL,
	reporte_id				NUMERIC 	NOT NULL,
    PRIMARY KEY(solicitudesXArea_id),
    CONSTRAINT fk_area_solicitudes_x_area FOREIGN KEY(area_id) REFERENCES  Area(area_id),
    CONSTRAINT fk_reporte_solicitudes_x_area FOREIGN KEY(reporte_id) REFERENCES  Reporte(reporte_id)
);

CREATE TABLE MetricasXTutorial(
	metricasXTutorial_id 	NUMERIC GENERATED BY DEFAULT ON NULL AS IDENTITY,
	calificación 			NUMBER(1,2) 	NOT NULL,
	numero_clicks 			NUMBER(10) 		NOT NULL,
	tutorial_id				NUMERIC 		NOT NULL,
	reporte_id				NUMERIC 		NOT NULL,
    PRIMARY KEY(metricasXTutorial_id),
    CONSTRAINT fk_tutorial_metricas_x_tutorial FOREIGN KEY (tutorial_id) REFERENCES  Tutorial(tutorial_id),
    CONSTRAINT fk_reporte_metricas_x_tutorial FOREIGN KEY (reporte_id) REFERENCES  Reporte(reporte_id)
);

CREATE TABLE Click(
	click_id 		NUMERIC GENERATED BY DEFAULT ON NULL AS IDENTITY,
	fecha_click 	DATE 		NOT NULL,
	tutorial_id		NUMERIC 	NOT NULL,
	empresa_id		NUMERIC 	NOT NULL,
    PRIMARY KEY(click_id),
    CONSTRAINT fk_tutorial_click FOREIGN KEY (tutorial_id) REFERENCES  Tutorial(tutorial_id),
    CONSTRAINT fk_empresa_click FOREIGN KEY (empresa_id) REFERENCES  Empresa(empresa_id)
);

CREATE TABLE Calificacion(
	calificacion_id 	NUMERIC GENERATED BY DEFAULT ON NULL AS IDENTITY,
	calificacion 		NUMBER(1) 	NOT NULL,
	resena 				VARCHAR(300)	,
	fecha_calificacion 	DATE			NOT NULL,
	tutorial_id			NUMERIC 		NOT NULL,
	empresa_id			NUMERIC 		NOT NULL,
    PRIMARY KEY(calificacion_id),
    CONSTRAINT fk_tutorial_calificacion FOREIGN KEY (tutorial_id) REFERENCES  Tutorial(tutorial_id),
    CONSTRAINT fk_empresa_calificacion FOREIGN KEY (empresa_id) REFERENCES  Empresa(empresa_id)
);

